<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cadenza â€“ Indian Vocal Music Academy</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Spline Viewer -->
  <script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.39/build/spline-viewer.js"></script>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="supabaseClient.js"></script>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    emailjs.init("AhtLZTPsQ3L2yS1Tw");
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    html { scroll-behavior: smooth; }
    body { font-family: 'Poppins', sans-serif; background-color: #F4EDE4; color: #3C2A1E; }
    .hero-gradient { background: linear-gradient(135deg, #754032 0%, #4A2C21 100%); }
    .service-card { transition: transform 0.4s cubic-bezier(0.4,0,0.2,1), box-shadow 0.4s ease; }
    .service-card:hover { transform: translateY(-8px); box-shadow: 0 25px 40px rgba(0,0,0,0.2); }
    .testimonial-card { transition: all 0.3s ease; }
    .testimonial-card:hover { transform: scale(1.03); }
    .nav-link { position: relative; }
    .nav-link::after {
      content: '';
      position: absolute; width: 0; height: 2px;
      bottom: 0; left: 0;
      background-color: #D4AF37;
      transition: width 0.3s ease;
    }
    .nav-link:hover::after { width: 100%; }
    spline-viewer { width: 90%; height: 469px; pointer-events: auto !important; }
    @media (max-width: 768px) {
      spline-viewer { height: 280px; transform: scale(1); transform-origin: center; }
    }
  </style>
</head>

<body class="text-[#3C2A1E]">
  <!-- Navigation Bar -->
  <nav class="fixed top-0 left-0 w-full z-50 bg-[#3C2A1E]/90 backdrop-blur-md shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-20">
        <!-- Logo -->
        <div class="text-[#D4AF37] font-bold text-2xl">
          Cadenza
        </div>
        <!-- Nav Links -->
        <div class="hidden md:flex gap-8 text-[#F4EDE4] font-medium">
          <a href="#about" class="nav-link hover:text-[#D4AF37] transition">About</a>
          <a href="#services" class="nav-link hover:text-[#D4AF37] transition">Courses</a>
          <a href="#testimonials" class="nav-link hover:text-[#D4AF37] transition">Testimonials</a>
          <a href="#contact" class="nav-link hover:text-[#D4AF37] transition">Contact</a>
        </div>
      </div>
    </div>
  </nav>

  <section class="relative pt-40 pb-40">
    <div class="absolute inset-0 bg-cover bg-center z-0" style="background-image: url('backgroundaiimg.jpg');"></div>

    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col lg:flex-row justify-center items-end gap-8">

        <!-- Only Box on Mobile -->
        <div class="bg-[#754032]/80 backdrop-blur-md rounded-xl p-8 shadow-lg text-center text-[#F4EDE4] w-full max-w-md block lg:hidden mt-[60%]">
          <h1 class="text-4xl md:text-5xl font-extrabold">
            Sing with<br>
            <span class="text-[#D4AF37]">Passion</span>
          </h1>
          <p class="mt-4 text-lg">Feel the rhythm, own the stage, and shine bright in your musical journey with us.</p>
          <a href="#contact" class="mt-6 inline-block bg-[#D4AF37] text-black px-6 py-3 font-semibold rounded-md hover:bg-yellow-400 transition">Enroll Now</a>
        </div>

        <!-- Two Boxes on Desktop -->
        <div class="hidden lg:flex lg:flex-row justify-between items-start gap-8 w-full">
          <!-- Left Box -->
          <div class="bg-[#754032]/80 backdrop-blur-md rounded-xl p-8 shadow-lg text-center text-[#F4EDE4] w-full lg:w-[25%]">
            <h1 class="text-4xl md:text-5xl font-extrabold">
              Discover Your<br>
              <span class="text-[#D4AF37]">Musical Potential</span>
            </h1>
            <p class="mt-4 text-lg">Cadenza is dedicated to nurturing musical talent through expert guidance in Indian classical and contemporary music forms.</p>
            <a href="#contact" class="mt-6 inline-block bg-[#D4AF37] text-black px-6 py-3 font-semibold rounded-md hover:bg-yellow-400 transition">Enroll Now</a>
          </div>

          <!-- Right Box -->
          <div class="bg-[#754032]/80 backdrop-blur-md rounded-xl p-8 shadow-lg text-center text-[#F4EDE4] w-full lg:w-[25%]">
            <h1 class="text-4xl md:text-5xl font-extrabold">
              Sing with<br>
              <span class="text-[#D4AF37]">Passion</span>
            </h1>
            <p class="mt-4 text-lg">Feel the rhythm, own the stage, and shine bright in your musical journey with us.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="py-20 bg-white text-[#3C2A1E]">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h3 class="text-sm font-semibold text-purple-600 uppercase">About Us</h3>
      <h2 class="text-4xl font-extrabold mt-2">Our Dedication to Talent Development</h2>
      <p class="mt-4 text-xl max-w-3xl mx-auto text-gray-600">At Cadenza, we believe everyone has musical potential waiting to be discovered.</p>

      <div class="mt-12 grid gap-10 sm:grid-cols-2 lg:grid-cols-2 text-left">
        <div class="flex gap-4">
          <div class="bg-[#D4AF37] text-white p-4 rounded-lg">
            <i class="fas fa-music fa-lg"></i>
          </div>
          <div>
            <h4 class="text-lg font-semibold">Expert Instructors</h4>
            <p class="text-black">Our team consists of professionally certified and friendly teachers who are passionate about sharing their knowledge.</p>
          </div>
        </div>

        <div class="flex gap-4">
          <div class="bg-[#D4AF37] text-white p-4 rounded-lg">
            <i class="fas fa-user-graduate fa-lg"></i>
          </div>
          <div>
            <h4 class="text-lg font-semibold">Personalized Approach</h4>
            <p class="text-black">We tailor our teaching methods to suit each student's learning style and musical goals.</p>
          </div>
        </div>

        <div class="flex gap-4">
          <div class="bg-[#D4AF37] text-white p-4 rounded-lg">
            <i class="fas fa-trophy fa-lg"></i>
          </div>
          <div>
            <h4 class="text-lg font-semibold">Strong Foundations</h4>
            <p class="text-black">We emphasize building solid fundamentals that will serve students throughout their musical journey.</p>
          </div>
        </div>

        <div class="flex gap-4">
          <div class="bg-[#D4AF37] text-white p-4 rounded-lg">
            <i class="fas fa-heart fa-lg"></i>
          </div>
          <div>
            <h4 class="text-lg font-semibold">Cultural Preservation</h4>
            <p class="text-black">We're committed to preserving and promoting India's rich musical heritage while embracing contemporary forms.</p>
          </div>
        </div>
      </div>

      <!-- Spline Embed -->
      <div class="mt-16">
        <spline-viewer url="https://prod.spline.design/mWhJ2KL4kSoFz1GR/scene.splinecode"></spline-viewer>
      </div>
    </div>
  </section>

  <!-- Services Section -->
  <section id="services" class="py-16 bg-[#754032]">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-[#F4EDE4]">
      <h2 class="text-3xl font-bold">Our Services</h2>
      <p class="mt-4 text-lg max-w-2xl mx-auto">Comprehensive music training rooted in Indian classical excellence.</p>
      <div class="mt-10 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        
        <!-- Guitar -->
        <a href="guitar.html" class="block">
            <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
              <div class="h-48 bg-indigo-100 flex items-center justify-center rounded-t-xl">
                <i class="fas fa-guitar text-6xl text-indigo-600"></i>
              </div>
              <div class="pt-6">
                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold">Guitar</div>
                <h3 class="mt-2 text-xl font-semibold">Acoustic & Electric Guitar</h3>
                <p class="mt-3 text-gray-600">Begin with the fundamentals like scales and chords. Play your favorite songs or become the next rockstar with guidance at each level.</p>
              </div>
            </div>
          </a>

        <!-- Tabla -->
        <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
          <div class="h-48 bg-amber-100 flex items-center justify-center rounded-t-xl">
            <i class="fas fa-drum text-6xl text-amber-600"></i>
          </div>
          <div class="pt-6">
            <div class="uppercase tracking-wide text-sm text-amber-500 font-semibold">Percussion</div>
            <h3 class="mt-2 text-xl font-semibold">Tabla</h3>
            <p class="mt-3 text-gray-600">The heartbeat of Indian classical music. Learn to appreciate the versatility of Indian heritage while developing a strong tala foundation.</p>
          </div>
        </div>

        <!-- Hindustani Vocals -->
        <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
          <div class="h-48 bg-emerald-100 flex items-center justify-center rounded-t-xl">
            <i class="fas fa-microphone text-6xl text-emerald-600"></i>
          </div>
          <div class="pt-6">
            <div class="uppercase tracking-wide text-sm text-emerald-500 font-semibold">Vocals</div>
            <h3 class="mt-2 text-xl font-semibold">Hindustani & Bollywood Vocals</h3>
            <p class="mt-3 text-gray-600">Learn voice culture, different ragas and talas while understanding the versatility of Indian culture in this performance-based course.</p>
          </div>
        </div>

        <!-- Bollywood Vocals -->
        <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
          <div class="h-48 bg-rose-100 flex items-center justify-center rounded-t-xl">
            <i class="fas fa-film text-6xl text-rose-600"></i>
          </div>
          <div class="pt-6">
            <div class="uppercase tracking-wide text-sm text-rose-500 font-semibold">Vocals</div>
            <h3 class="mt-2 text-xl font-semibold">Piano</h3>
            <p class="mt-3 text-gray-600">Learn piano as a hobby or learn your favorite songs. We help with your training and foundational skills.</p>
          </div>
        </div>

        <!-- Kathak -->
        <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
          <div class="h-48 bg-purple-100 flex items-center justify-center rounded-t-xl">
            <i class="fas fa-child text-6xl text-purple-600"></i>
          </div>
          <div class="pt-6">
            <div class="uppercase tracking-wide text-sm text-purple-500 font-semibold">Dance</div>
            <h3 class="mt-2 text-xl font-semibold">Kathak</h3>
            <p class="mt-3 text-gray-600">Learn one of India's most revered classical dance forms, building from simple footwork to expressive dance movements.</p>
          </div>
        </div>

        <!-- Music Production -->
        <div class="service-card bg-[#F4EDE4] text-[#3C2A1E] p-6 rounded-xl">
          <div class="h-48 bg-blue-100 flex items-center justify-center rounded-t-xl">
            <i class="fas fa-compact-disc text-6xl text-blue-600"></i>
          </div>
          <div class="pt-6">
            <div class="uppercase tracking-wide text-sm text-blue-500 font-semibold">Production</div>
            <h3 class="mt-2 text-xl font-semibold">Music Production</h3>
            <p class="mt-3 text-gray-600">Make your own music or tracks with guidance at each level. Learn beat making, music production, and mixing/mastering from scratch.</p>
          </div>
        </div>

      </div>
    </div>
  </section>


  <!-- Testimonials Section -->
  <section id="testimonials" class="py-16 bg-[#F4EDE4]">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-bold">What Our Students Say</h2>
      <div class="mt-10 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        <div class="testimonial-card p-6 bg-white rounded-lg shadow">
          <p class="text-lg">"Cadenza gave me confidence in my voice and stage presence!"</p>
          <p class="mt-4 font-semibold">Rahul Sharma</p>
        </div>
        <div class="testimonial-card p-6 bg-white rounded-lg shadow">
          <p class="text-lg">"The blend of tradition and innovation here is perfect."</p>
          <p class="mt-4 font-semibold">Priya Patel</p>
        </div>
        <div class="testimonial-card p-6 bg-white rounded-lg shadow">
          <p class="text-lg">"Amazing teachers and a great riyaaz routine!"</p>
          <p class="mt-4 font-semibold">Arjun Mehta</p>
        </div>
      </div>
    </div>
  </section>
  <!-- Contact & Scheduler Section -->
<section id="contact" class="py-16 hero-gradient text-[#F4EDE4]">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"> <!-- Changed from max-w-4xl to max-w-6xl -->
    <div class="bg-white rounded-xl shadow-lg p-8 flex flex-col md:flex-row gap-8 text-[#3C2A1E]">
      <!-- Unified Form -->
      <form id="unifiedForm" class="w-full md:w-1/2 space-y-4 flex flex-col justify-between">
        <div>
          <h2 class="text-3xl font-bold mb-4">Start Your Musical Journey & Book a Session</h2>
          <p class="mb-6">Fill the form and select a slot to schedule your class!</p>
          <input id="visitor_name" name="visitor_name" class="w-full p-3 rounded-md border border-[#D4AF37] bg-white mb-2" type="text" placeholder="Your Name" required />
          <input id="visitor_email" name="visitor_email" class="w-full p-3 rounded-md border border-[#D4AF37] bg-white mb-2" type="email" placeholder="Your Email" required />
          <input id="visitor_whatsapp" name="visitor_whatsapp" class="w-full p-3 rounded-md border border-[#D4AF37] bg-white mb-2" type="text" placeholder="Contact / WhatsApp" required />
        </div>
        <!-- Hidden fields to store calendar info -->
        <input type="hidden" id="calendar_date" name="calendar_date" required />
        <input type="hidden" id="calendar_time" name="calendar_time" required />
        <input type="hidden" id="calendar_timezone" name="calendar_timezone" required />
        <input type="hidden" id="calendar_link" name="calendar_link" required />
        <button type="submit" id="schedule-btn" class="w-full bg-[#D4AF37] hover:bg-yellow-400 text-black px-6 py-3 rounded-md font-semibold transition text-lg mt-4">
          Schedule Your Class Now!
        </button>
      </form>
      <!-- Calendar Scheduler -->
      <div class="w-full md:w-1/2">
        <h2 class="text-2xl font-bold mb-4 text-[#3C2A1E]">Pick a Time Slot</h2>
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <iframe
            id="calendar-iframe"
            src="calendar.html"
            class="w-full h-[80vh] md:h-[600px] border-none"
            title="Class Scheduler">
          </iframe>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Success Modal -->
<div id="success-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
  <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4 relative">
    <!-- Cross Button -->
    <button id="close-success-modal" class="absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none" aria-label="Close">&times;</button>
    <div class="text-center">
      <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
        <i class="fas fa-check text-green-600"></i>
      </div>
      <h3 class="mt-3 text-lg font-medium text-gray-900">
        Your class has been scheduled!<br>
        You can add it to your Google Calendar with the button below.
      </h3>
      <div class="mt-4">
        <a id="calendar-link-modal-btn"
           href="#"
           target="_blank"
           class="inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-[#D4AF37] text-base font-medium text-black hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:text-sm"
           style="min-width:220px;">
          Schedule in your Google Calendar
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  // Store calendar info from iframe
  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'calendar-link' && event.data.url) {
      // Show the modal
      document.getElementById('success-modal').classList.remove('hidden');
      // Set the Google Calendar link on the modal button
      document.getElementById('calendar-link-modal-btn').href = event.data.url;

      // Fill hidden fields for form submission
      document.getElementById('calendar_link').value = event.data.url;
      if (event.data.date) document.getElementById('calendar_date').value = event.data.date;
      if (event.data.time) document.getElementById('calendar_time').value = event.data.time;
      if (event.data.timezone) document.getElementById('calendar_timezone').value = event.data.timezone;
    }
    // Listen for slot selection info from calendar.html
    if (event.data && event.data.type === 'calendar-info') {
      if (event.data.date) document.getElementById('calendar_date').value = event.data.date;
      if (event.data.time) document.getElementById('calendar_time').value = event.data.time;
      if (event.data.timezone) document.getElementById('calendar_timezone').value = event.data.timezone;
    }
  });

  // Close modal with the cross button
  document.getElementById('close-success-modal').addEventListener('click', function() {
    document.getElementById('success-modal').classList.add('hidden');
  });

  // Optional: Hide modal when user clicks outside the popup or presses Escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      document.getElementById('success-modal').classList.add('hidden');
    }
  });
  document.getElementById('success-modal').addEventListener('click', function(e) {
    if (e.target === this) {
      this.classList.add('hidden');
    }
  });

  // Unified form validation and EmailJS send
  document.getElementById('unifiedForm').addEventListener('submit', function(e) {
    e.preventDefault();

    // Validate all required fields
    const name = document.getElementById('visitor_name').value.trim();
    const email = document.getElementById('visitor_email').value.trim();
    const whatsapp = document.getElementById('visitor_whatsapp').value.trim();
    const calendar_date = document.getElementById('calendar_date').value.trim();
    const calendar_time = document.getElementById('calendar_time').value.trim();
    const calendar_timezone = document.getElementById('calendar_timezone').value.trim();

    if (!name || !email || !whatsapp || !calendar_date || !calendar_time || !calendar_timezone) {
      alert('Please fill out all fields and select a time slot before scheduling.');
      return;
    }

    // --- Generate Google Calendar Link ---
    const [startStr, endStr] = calendar_time.split(' - ');
    function parseTime(date, timeStr) {
      const [time, modifier] = timeStr.split(' ');
      let [hours, minutes] = time.split(':').map(Number);
      if (modifier === 'PM' && hours < 12) hours += 12;
      if (modifier === 'AM' && hours === 12) hours = 0;
      const d = new Date(date);
      d.setHours(hours, minutes, 0, 0);
      return d;
    }
    const startDate = parseTime(calendar_date, startStr);
    const endDate = parseTime(calendar_date, endStr);

    function formatGoogleDate(date) {
      return date.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}Z$/, 'Z');
    }
    const startUTC = formatGoogleDate(startDate);
    const endUTC = formatGoogleDate(endDate);

    const eventTitle = name + ' - Music Trial';
    const eventDescription = '';
    const location = '';

    const googleCalendarUrl =
      `https://www.google.com/calendar/render?action=TEMPLATE` +
      `&text=${encodeURIComponent(eventTitle)}` +
      `&details=${encodeURIComponent(eventDescription)}` +
      `&location=${encodeURIComponent(location)}` +
      `&dates=${startUTC}/${endUTC}` +
      `&ctz=${encodeURIComponent(calendar_timezone)}`;

    document.getElementById('calendar_link').value = googleCalendarUrl;

    // Log what will be sent to EmailJS
    const emailData = {
      name: name,
      email: email,
      date: calendar_date,
      time: calendar_time,
      timezone: calendar_timezone,
      calendar_link: googleCalendarUrl
    };
    console.log("Sending to EmailJS:", emailData);

    // Send to EmailJS
    emailjs.send('service_s69ud1n', 'template_x8ylvsr', emailData)
      .then(function(response) {
        console.log("EmailJS success:", response);
        document.getElementById('success-modal').classList.remove('hidden');
        document.getElementById('calendar-link-modal-btn').href = googleCalendarUrl;
      }, function(error) {
        console.error("EmailJS error:", error);
        alert('There was an error sending your email. Please try again.');
      });
  });
</script>
</body>
</html>
